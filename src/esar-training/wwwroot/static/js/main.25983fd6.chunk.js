(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{127:function(e,t,a){},135:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),i=a.n(o),c=a(12),s=a(22),l=a(11),u=a.n(l),m=(a(96),a(97),a(7)),d=a(10),p=a(8),h=a(6),f=a(9),g=a(151),b=a(152),E=a(153),v=a(154),y=a(155),k=a(15),w=a(25),O=a(31),S=a(29),j=a(58),I=a(59),C=Object.assign({client_id:"esar-trainingapp",redirect_uri:"".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":".concat(window.location.port):"").concat(window.baseUrl||"/","loggedIn"),response_type:"token id_token",scope:"openid profile database-api auth-api",authority:"http://localhost:5100",silent_redirect_uri:"".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":".concat(window.location.port):"").concat(window.baseUrl||"/","silent_renew.html"),automaticSilentRenew:!0,filterProtocolClaims:!0,loadUserInfo:!0},window.siteAuth),N=Object(s.createUserManager)(C),R="REQUEST_RECORDS",T="RECEIVE_RECORDS",A="UPDATE_PROGRESS",M="REQUEST_SESSIONS",L="RECEIVE_SESSIONS",x="SET_MEMBER",P="SIGNING_OUT",D="RECEIVE_ROLES",_="REQUEST_TRAINEES",U="RECEIVE_TRAINEES",q="REQUEST_TRAINEE",F="RECEIVE_TRAINEE",B="REQUEST_ROSTER",W="RECEIVE_ROSTER",G="LEAVING_SESSION",H="JOINING_SESSION";function Q(){return function(e,t){var a=t();return e({type:R}),u.a.get("".concat(a.config.remoteRoot,"/members/").concat(a.member.id||a.oidc.user.profile.memberId)).then(function(t){return e({type:x,payload:t.data}),u.a.get("".concat(a.config.remoteRoot,"/members/").concat(a.member.id||a.oidc.user.profile.memberId,"/trainingrecords"))}).then(function(t){return e({type:T,payload:{data:t.data.items,filterNames:a.tasks.map(function(e){return e.title})}})}).then(function(){return e({type:A,payload:t()})})}}function J(e){return function(t,a){var n=a(),r=e?n.member.id:null;return t({type:M,payload:{memberId:r}}),u.a.get("".concat(n.config.localRoot,"/api/schedule")+(e?"/".concat(n.member.id||n.oidc.user.profile.memberId):"")).then(function(e){return t({type:L,payload:{data:e.data.items,memberId:r}})}).then(function(){return t({type:A,payload:a()})})}}function V(e,t){return function(a,n){var r=n();return a({type:B,payload:{courseName:e,session:t}}),u.a.get("".concat(r.config.localRoot,"/api/sessions/").concat(t.id,"/roster")).then(function(r){a({type:W,payload:{data:r.data,courseName:e,session:t}});var o=r.data.map(function(e){return(t=e.memberId,function(e,a){var n=a(),r=null;return(n.trainees.items||[]).find(function(e){return e.id.toLowerCase()===t.toLowerCase()})?Promise.resolve():(e({type:q,payload:{id:t}}),u.a.get("".concat(n.config.remoteRoot,"/members/").concat(t)).then(function(a){return r=a.data,u.a.get("".concat(n.config.remoteRoot,"/members/").concat(t,"/contacts")).then(function(t){e({type:F,payload:{member:r,contacts:t.data}})})}))})(a,n);var t});return Promise.all(o)})}}var z=a(14),K=a.n(z),Y={online:function(e,t){var a=(t.records.items||[])[e.title]||{};return{status:a.completed?"Complete":null,completed:a.completed?K()(a.completed):null}},session:function(e,t){var a=(t.records.items||[])[e.title]||{};return{status:a.completed?"Complete":null,completed:a.completed?K()(a.completed):null}},paperwork:function(e,t){switch(e.title){case"Background Check":return{status:t.member.backgroundKnown?"Complete":null,completed:!!t.member.backgroundKnown};default:var a=(t.records.items||[])[e.title];return a?{status:a.completed?"Complete":null,completed:a.completed?K()(a.completed):null}:{status:null}}},personal:function(e,t){return{status:null}}};var Z=a(19);var $={oidc:{signedIn:!1,user:Object.keys(sessionStorage).filter(function(e){return e.startsWith("oidc.user")}).length?{}:null},tasks:[{title:"Contact Information",summary:"Address, Email, Phone Number",category:"personal"},{title:"Emergency Contacts",summary:"Who to call in an emergency",category:"personal"},{title:"ICS-100",summary:"FEMA required online course",category:"online",details:"ICS 100, Introduction to the Incident Command System, introduces the Incident Command System (ICS) and provides the foundation for higher level ICS training. This course describes the history, features and principles, and organizational structure of the Incident Command System. It also explains the relationship between ICS and the National Incident Management System (NIMS).\n\nhttps://training.fema.gov/is/courseoverview.aspx?code=IS-100.b"},{title:"ICS-700",summary:"FEMA required online course",category:"online",details:"This course introduces and overviews the National Incident Management System (NIMS). NIMS provides a consistent nationwide template to enable all government, private-sector, and nongovernmental organizations to work together during domestic incidents.\n\nhttps://training.fema.gov/is/courseoverview.aspx?code=IS-700.a"},{title:"Course A",summary:"Evening orientation",category:"session",details:"This is an in-town weeknight informational meeting used to present ESAR objectives, organization and procedures.\n\nDiscussions center on basic training course content, requirements for team member field qualification, and personal equipment needs.",hours:2},{title:"Course B",summary:"Indoor navigation course",category:"session",prereqs:["Course A"],hours:9},{title:"First Aid",summary:"American Heart (AHA), Red Cross (ARC) or equivalent First Aid card",category:"paperwork",details:"Submit a scan or picture of a current first aid card to training.admin@kcesar.org"},{title:"CPR",summary:"American Heart (AHA), Red Cross (ARC) or equivalent CPR card",category:"paperwork",details:"Submit a scan or picture of a current CPR card to training.admin@kcesar.org"},{title:"ESAR F/A - Basic",summary:"",category:"session",hours:3,prereqs:["Course A","First Aid","CPR"]},{title:"ESAR F/A - Intermediate",summary:"",category:"session",hours:3,prereqs:["Course B","ESAR F/A - Basic"]},{title:"Background Check",summary:"Sheriff's Office application",category:"paperwork",details:"All potential KCESAR members submit an application to the King County Sheriff's office, who will conduct a criminal background check on the applicant.\n\nThis status will be updated when we are informed that you have passed this check. KCESAR does not receive the result of the background check except a pass/fail from the sheriff's office."},{title:"LFL Registration",summary:"For youth members",category:"paperwork"},{title:"Course C",summary:"Outdoor weekend - Intro to SAR",category:"session",hours:32.5,prereqs:["Course B","ESAR F/A - Basic"]},{title:"Course I",summary:"Outdoor weekend - Navigation",category:"session",prereqs:["Course C"],hours:31},{title:"Course II",summary:"Outdoor weekend - Evaluation",category:"session",prereqs:["Course I"],hours:31},{title:"ESAR F/A - Advanced",summary:"SAR specific first aid",category:"session",prereqs:["Course II","ESAR F/A - Intermediate"],hours:9},{title:"Course III",summary:"Outdoor weekend - mock mission",category:"session",prereqs:["ESAR F/A - Advanced","ICS-100","ICS-700"],hours:31},{title:"ESAR Ops Orientation",summary:"Information for new graduates about responding to missions, etc.",category:"session",prereqs:["Course III"],hours:2}],trainees:[],records:{loaded:!1,loading:!1},progress:{},config:Object.assign({localRoot:"",remoteRoot:"http://localhost:4944/api2",authRoot:"http://localhost:5100",unitId:"C2F99BB4-3056-4097-9345-4B8797F40E10"},window.siteConfig)},X=[j.a];if(localStorage&&localStorage.showLogging){var ee=Object(I.createLogger)();X.push(ee)}var te=Object(S.c)({oidc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=Object(s.reducer)(e,t);switch(t.type){case P:return{signingOut:!0};case D:return Object(Z.a)({},e,{roles:t.payload.roles});case"redux-oidc/USER_FOUND":return Object(Z.a)({},a,{expired:!1,signedIn:!0});case"redux-oidc/USER_EXPIRED":return Object(Z.a)({},a,{expired:!0,signedIn:!1});default:return a}},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];arguments.length>1&&arguments[1];return e},config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];arguments.length>1&&arguments[1];return e},records:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return Object.assign({},e,{loading:!0});case T:var a=t.payload.filterNames.reduce(function(e,t){return e[t]=!0,e},{}),n=t.payload.data.filter(function(e){return a[e.course.name]}).sort(function(e){return e.completed}).reduce(function(e,t){var a;return e[t.course.name]=((a=t).completed=a.completed?K()(a.completed):null,a.expires=a.expires?K()(a.expires):null,a),e},{});return Object.assign({},e,{loading:!1,loaded:!0,items:n});default:return e}},trainees:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(Z.a)({},e,{loading:!0});case U:return Object(Z.a)({},e,{loading:!1,loaded:!0},t.payload);case F:return function(e,t){var a=Object.assign({},t.member,{contacts:t.contacts}),n=Object(Z.a)({},e,{items:(e.items||[]).map(function(e){return e.id===t.member.id?Object.assign({},e,a):e})});return n.items.push(a),n}(e,t.payload);default:return e}},progress:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return t.payload.tasks.reduce(function(e,a){return e[a.title]=function(e,t,a){for(var n=Y[e.category](e,a),r=[],o=0;o<(e.prereqs||[]).length;o++){var i=e.prereqs[o];"Complete"!==t[i].status&&r.push(i)}return Object.assign(n,{available:"personal"!==e.category&&!n.completed&&!r.length,blocked:"personal"===e.category?null:r.length?r:null})}(a,e,t.payload),e},{});default:return e}},schedule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loaded:!1,loading:!1,courses:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(Z.a)({},e,{loading:!0,memberId:t.payload.memberId});case L:return{loading:!1,loaded:!0,memberId:t.payload.data,courses:t.payload.data};default:return e}},roster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loaded:!1,loading:!1,items:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return Object(Z.a)({},e,{loading:!0,session:t.payload.session,courseName:t.payload.courseName});case W:return Object.assign({},e,{loading:!1,loaded:!0,items:t.payload.data});default:return e}},member:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return t.payload;default:return e}}}),ae=Object(S.d)(te,$,S.a.apply(void 0,X)),ne=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).successCallback=function(){a.props.history.push(sessionStorage.redirect||"/")},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(s.CallbackComponent,{userManager:N,successCallback:this.successCallback,errorCallback:this.successCallback},r.a.createElement("div",null,"Redirecting..."))}}]),t}(r.a.Component);var re=Object(w.e)(Object(c.b)(null,function(e){return{dispatch:e}})(ne)),oe=a(61),ie=a.n(oe),ce=(a(125),a(126),a(127),a(62)),se=a.n(ce),le=a(63),ue=a.n(le),me=a(64),de=a.n(me),pe=a(65),he=a.n(pe),fe=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e={dots:!0,infinite:!0,autoplay:!0,autoplaySpeed:4e3};return r.a.createElement("div",{className:"container py-4"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"sliderContainer col"},r.a.createElement(ie.a,Object.assign({},e,{settings:e}),r.a.createElement("div",null,r.a.createElement("img",{src:se.a,alt:"Trainees and staff"})),r.a.createElement("div",null,r.a.createElement("img",{src:ue.a,alt:"Practicing an evacuation"})),r.a.createElement("div",null,r.a.createElement("img",{src:de.a,alt:"Searching in the woods"})),r.a.createElement("div",null,r.a.createElement("img",{src:he.a,alt:"Working with a wheeled litter (stretcher)"}))))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("p",null,"Welcome to King County Explorer Search and Rescue's (ESAR's) basic training program. Our series of trainings will cover everything necessary to start participating in search and rescue missions in King County and across Washington State. Previous training in search and rescue techniques is not required and we'll cover the basics of outdoor travel, navigation and first aid."))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("p",null,"You can learn more about the training program at ",r.a.createElement("a",{href:"http://kcesar.org/recruiting.html"},"our web site")),r.a.createElement("p",null,"Existing trainees can sign in below and start tracking their progress."))),r.a.createElement("div",{className:"row justify-content-around"},r.a.createElement("a",{href:"/me",className:"btn btn-primary col-11 col-sm-4 my-2"},"Trainee Signin")))}}]),t}(n.Component),ge=Object(c.b)(function(e){return{route:e.routing}},function(e,t){return{}})(fe),be=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).loginIfNeeded(),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(){this.loginIfNeeded()}},{key:"loginIfNeeded",value:function(){var e=this.props,t=e.oidc,a=e.getRoles;if(!t.roles&&!t.signingOut){if(t.user&&t.user.profile)return a(t.user.profile.sub);sessionStorage.setItem("redirect",window.location.pathname+window.location.search+window.location.hash),N.signinRedirect()}}},{key:"render",value:function(){var e=(this.props||{}).oidc;return e.expired?r.a.createElement("div",null,r.a.createElement("strong",null,"Your session has timed out.")):r.a.createElement("div",null,e.user&&e.user.token_type?this.props.children:null)}}]),t}(n.Component),Ee=Object(c.b)(function(e){return{oidc:e.oidc}},function(e,t){return{getRoles:function(t){return e(function(e){return function(t,a){var n=a();return u.a.get("".concat(n.config.authRoot,"/Account/").concat(e,"/Groups")).then(function(a){t({type:D,payload:{roles:a.data.data,userId:e}})})}}(t))}}})(be);function ve(e,t){return!!e&&(Array.isArray(e)?e.filter(function(e){return e===t}).length>0:e===t)}var ye=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.memberId,a=e.user,n=e.roles,o=e.children,i=e.group,c=e.allowSelf,s=e.allowMember,l=e.allowAdmin,u=e.showDenied,m=a&&a.access_token,d=m&&s&&ve(n,"cdb.users"),p=m&&l&&ve(n,"esar.training"),h=c&&function(e,t){return!!t&&!(!e||!e.access_token)&&e.profile&&e.profile.memberId&&e.profile.memberId.toLowerCase()===t.toLowerCase()}(a,t);return i&&ve(n,i)||d||h||p?r.a.createElement("div",null,o):m?u?r.a.createElement("div",null,"no access"):null:r.a.createElement("div",null,"loading ...")}}]),t}(n.Component),ke=Object(c.b)(function(e){return{user:(e.oidc||{}).user,roles:(e.oidc||{}).roles,memberId:(e.member||{}).id}},null)(ye),we=a(28),Oe=a(69),Se=a(138),je=a(139),Ie=a(140),Ce=a(141),Ne=a(142),Re=a(143),Te=a(156),Ae=a(144),Me=a(145),Le=a(146),xe=a(66),Pe=a.n(xe),De=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("p",{className:"text-muted",style:{marginTop:"1rem"}},this.props.children)}}]),t}(n.Component),_e=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=Pe()(this.props.markdown||"",{sanitize:!0});return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}})}}]),t}(n.Component),Ue=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){a.props.onPick(a.props.task)},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.task,a=e.schedule,n=t.title,o=null;if(a&&a.courses[t.title]){var i=a.courses[t.title].filter(function(e){return"no"!==e.registered}).sort(function(e,t){return e.registered<t.registered});i.length&&(o="yes"===i[0].registered?"Registered":"wait"===i[0].registered?"Wait List":i[0].registered)}return r.a.createElement(qe,{text:n,secondary:t.summary,onClick:this.onClick,badge:o,loading:"session"===t.category&&(a||{}).loading})}}]),t}(n.Component),qe=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,a=e.secondary,n=e.badge,o=e.loading;return r.a.createElement(Se.a,{tag:"button",action:!0,onClick:this.props.onClick},r.a.createElement(je.a,{className:"justify-content-between",style:{flexWrap:"wrap"}},t,n?r.a.createElement(Ie.a,{pill:!0},n):null,o?r.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin"}):null),r.a.createElement(Ce.a,null,a))}}]),t}(n.Component),Fe=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).renderBody=function(){var e=a.props.task;return r.a.createElement(_e,{markdown:e.details})},a.renderPrereqs=function(){var e=a.props,t=e.task,n=e.progress,o=(t.prereqs||[]).map(function(e){return r.a.createElement(Se.a,{key:e},r.a.createElement("div",{className:"hanging-fa-fw"},r.a.createElement("i",{className:"fa fa-fw ".concat(n[e].completed?"fa-check-square-o text-success":"fa-square-o")}),e))});return o.length?r.a.createElement("div",null,r.a.createElement("h6",null,"Prerequisites:"),r.a.createElement(Ne.a,null,o)):null},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.task,t=this.renderProgress(),a=this.renderPrereqs();return r.a.createElement("div",null,r.a.createElement("h5",{className:"dialog-subtitle"},e.summary),this.renderBody(),t||a?r.a.createElement("hr",null):null,t,a)}},{key:"renderProgress",value:function(){var e=this.props.record;return e&&e.completed&&(!e.expires||e.expires.isAfter(K()()))?r.a.createElement("p",{className:"text-success"},"You completed this task",!0===e.completed?"":" "+e.completed.fromNow(),"."):r.a.createElement("strong",null,"You still need to complete this task")}}]),t}(n.Component),Be={session:function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={leavePrompt:null,leaving:!1,joinPrompt:null,joining:!1},a.onClickLeave=function(e){a.setState({leavePrompt:e})},a.onConfirmLeave=function(){a.setState({leaving:!0}),a.props.actions.doLeave(a.state.leavePrompt.id).then(function(e){a.setState({leavePrompt:null})}).catch(function(){}).then(function(){a.setState({leaving:!1})})},a.onClickJoin=function(e){a.setState({joining:!0,joinPrompt:e}),a.props.actions.doJoin(e.id).then(function(e){a.setState({joinPrompt:null})}).catch(function(){}).then(function(){a.setState({joining:!1})})},a.renderLocation=function(e){return e},a.renderProgress=a.renderProgress.bind(Object(we.a)(a)),a.onConfirmLeave=a.onConfirmLeave.bind(Object(we.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"renderProgress",value:function(){var e=this,a=this.props,n=a.task,o=a.schedule,i=a.progress,c=o.courses[n.title],s=Object(Oe.a)(Object(h.a)(t.prototype),"renderProgress",this).call(this),l=i[n.title];if(!c||l.completed)return s;var u=l.blocked&&l.blocked.length;return c?r.a.createElement("div",null,s,u?r.a.createElement("div",null,r.a.createElement("small",null,"You'll be able to register after completing the prerequisites")):null,r.a.createElement("div",null,"Class Schedule:"),r.a.createElement(Ne.a,{style:{marginBottom:"1em"}},c.map(function(t){var a=K()(t.when),o=K()(t.when).add(n.hours,"hour"),i=a.isSame(o,"day")?a.format("MMM Do h:mma"):a.format("MMM D")+" - "+o.format(a.isSame(o,"month")?"D":"MMM Do"),s=c.find(function(e){return t.id===e.id&&"no"!==e.registered}),l="".concat(t.current,"/").concat(t.capacity," filled")+(t.waiting?", ".concat(t.waiting," waiting"):""),m=t.current>=t.capacity||t.waiting?"Join Wait List":"Register",d=t===s?r.a.createElement(Re.a,{disabled:e.state.leaving||e.state.joining,style:{padding:0},color:"link",onClick:function(){return e.onClickLeave(t)}},"Leave"):r.a.createElement(Re.a,{disabled:e.state.leaving||e.state.joining,style:{padding:0},color:"link",onClick:function(){return e.onClickJoin(t)}},e.state.joining&&t===e.state.joinPrompt?r.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin",style:{marginRight:5}}):null,m),p=u?r.a.createElement(ke,{allowAdmin:!0},d):r.a.createElement(ke,{allowSelf:!0,allowAdmin:!0},d),h=t===s?"wait"===t.registered?r.a.createElement("span",null,", ",r.a.createElement("strong",null,"Wait Listed")):r.a.createElement("span",null,", ",r.a.createElement("strong",null,"Registered")):null,f=K()().isAfter(t.when)?null:r.a.createElement("div",{className:"justify-content-between"},r.a.createElement("div",null,l,h),p);return r.a.createElement(Se.a,{key:t.when,style:{flexDirection:"column",alignItems:"stretch"}},r.a.createElement("div",{className:"justify-content-between"},r.a.createElement("strong",null,i),r.a.createElement("span",null,e.renderLocation(t.location))),f)})),this.state.leavePrompt?r.a.createElement(O.Gateway,{into:"root"},r.a.createElement(Te.a,{isOpen:!0},r.a.createElement(Ae.a,null,"Leave Session"),r.a.createElement(Me.a,null,r.a.createElement("p",null,"If you leave this session and then choose to re-register you may be placed at the end of a wait list."),r.a.createElement("p",null," Do you want to leave the ",n.title," session ",K()(this.state.leavePrompt.when).calendar(null,{sameElse:"[on] MMM Do"}),"?")),r.a.createElement(Le.a,null,r.a.createElement(Re.a,{disabled:this.state.leaving,color:"danger",onClick:this.onConfirmLeave},"Leave",this.state.leaving?r.a.createElement("i",{style:{marginLeft:10},className:"fa fa-circle-o-notch fa-spin"}):null),r.a.createElement(Re.a,{disabled:this.state.leaving,outline:!0,color:"primary",onClick:function(){return e.setState({leavePrompt:null})}},"Cancel")))):null):s}}]),t}(Fe),online:function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),t}(Fe),paperwork:Fe},We=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={infoDialog:null,infoTitle:null},a.openTaskInfo=function(e){var t=a.props.progress[e.title];a.setState({infoDialog:a.buildInfoBody(e,t),infoTitle:e.title})},a.closeInfo=function(){a.setState({infoDialog:null,infoTitle:null})},a.buildInfoBody=function(e,t){var n=Be[e.category],o="session"===e.category?{doLeave:a.props.doLeaveSession,doJoin:a.props.doJoinSession}:{};return n?r.a.createElement(n,{task:e,record:t,progress:a.props.progress,schedule:a.props.schedule,actions:o}):r.a.createElement("div",null,"No information")},a.buildListItem=function(e,t){return r.a.createElement(Ue,{key:e.title,task:e,onPick:a.openTaskInfo,schedule:t})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.getUserData,a=e.getSchedule;t(),a()}},{key:"render",value:function(){var e=this,t=this.props,a=t.tasks,n=t.records,o=t.progress,i=t.schedule;return r.a.createElement("div",null,r.a.createElement(De,null,"Personal Information"),r.a.createElement(Ne.a,{className:"indent"},r.a.createElement(qe,{text:"Contact Information",secondary:"Address, Email, Phone number"}),r.a.createElement(qe,{text:"Emergency Contacts",secondary:"Who to call in an emergency"})),r.a.createElement(De,null,"Available Tasks"),r.a.createElement(Ne.a,{className:"indent"},a.filter(function(e){return o[e.title]&&o[e.title].available}).map(function(t){return e.buildListItem(t,i)})),r.a.createElement(De,null,"Blocked Tasks"),r.a.createElement(Ne.a,{className:"indent"},a.filter(function(e){return o[e.title]&&o[e.title].blocked}).map(function(t){return e.buildListItem(t,i)})),r.a.createElement(De,null,"Completed Tasks"),r.a.createElement(Ne.a,{className:"indent"},a.filter(function(e){return o[e.title]&&o[e.title].completed}).map(function(t){return e.buildListItem(t)})),r.a.createElement(Te.a,{isOpen:!!n.loading},r.a.createElement(Me.a,null,"Loading ...")),r.a.createElement(Te.a,{isOpen:!!this.state.infoDialog,toggle:this.closeInfo},r.a.createElement(Ae.a,{toggle:this.closeInfo},this.state.infoTitle),r.a.createElement(Me.a,null,this.state.infoDialog),r.a.createElement(Le.a,null,r.a.createElement(Re.a,{color:"outline-primary",onClick:this.closeInfo},"Close"))))}}]),t}(n.Component),Ge=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.member,a=e.oidc;return r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(Ee,{oidc:a},r.a.createElement(ke,{allowMember:!0},r.a.createElement("div",null,r.a.createElement(k.b,{to:"/admin/trainees"},"< Trainees List"))),r.a.createElement(ke,{allowSelf:!0,allowMember:!0,showDenied:!0},r.a.createElement("div",null,t?t.name:""),r.a.createElement(We,this.props))))}}]),t}(n.Component),He=Object(c.b)(function(e){return{oidc:e.oidc,member:e.member,tasks:e.tasks,records:e.records,progress:e.progress,schedule:e.schedule}},function(e,t){return{getUserData:function(){return e(Q())},getSchedule:function(){return e(J(!0))},doLeaveSession:function(t){return e((a=t,function(e,t){var n=t();return e({type:G,payload:{id:a}}),u.a.delete("".concat(n.config.localRoot,"/api/schedule/").concat(n.member.id,"/session/").concat(a)).then(function(t){return e({type:L,payload:{data:t.data.result.items}}),t.data})}));var a},doJoinSession:function(t){return e((a=t,function(e,t){var n=t();return e({type:H,payload:{id:a}}),u.a.post("".concat(n.config.localRoot,"/api/schedule/").concat(n.member.id,"/session/").concat(a)).then(function(t){return e({type:L,payload:{data:t.data.result.items}}),t.data})}));var a}}})(Ge),Qe=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){(this.props.oidc.user||{}).access_token&&this.props.getTraineesData()}},{key:"componentDidUpdate",value:function(e){!this.props.oidc.user&&!{}.access_token||(e.oidc.user||{}).access_token||this.props.getTraineesData()}},{key:"render",value:function(){var e=this.props,t=e.oidc,a=e.trainees,n=e.config,o=a.loaded?r.a.createElement(Ne.a,null,a.items.map(function(e){return r.a.createElement(Se.a,{tag:k.b,to:n.localRoot+"/admin/trainees/"+e.member.id,action:!0},e.member.name)})):r.a.createElement("div",null,"Loading ...");return r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(Ee,{oidc:t},r.a.createElement(ke,{allowMember:!0,showDenied:!0},r.a.createElement(k.b,{to:"/admin"},"< Admin Home"),r.a.createElement("div",null,"Trainee List"),o)))}}]),t}(n.Component),Je=Object(c.b)(function(e){return{config:e.config,oidc:e.oidc,trainees:e.trainees}},function(e,t){return{getTraineesData:function(){return e(function(e,t){var a=t();return e({type:_}),u.a.get("".concat(a.config.remoteRoot,"/units/").concat(a.config.unitId,"/memberships/bystatus/trainee")).then(function(t){e({type:U,payload:t.data})})})}}})(Qe),Ve=function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.oidc;return r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(Ee,{oidc:e},r.a.createElement(ke,{allowMember:!0,showDenied:!0},r.a.createElement(Ne.a,null,r.a.createElement(Se.a,{tag:k.b,to:"/admin/trainees",action:!0},"List of Trainees"),r.a.createElement(Se.a,{tag:k.b,to:"/admin/courses",action:!0},"Course List"),r.a.createElement(ke,{group:"acct-managers"},r.a.createElement(Se.a,{tag:k.b,to:"/admin/register",action:!0},"Register Trainee"))))))}}]),t}(n.Component),ze=Object(c.b)(function(e){return{config:e.config,oidc:e.oidc}},function(e,t){return{}})(Ve),Ke=a(147),Ye=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={current:e.tasks[0].title},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(e){this.props.getScheduleData()}},{key:"render",value:function(){var e=this,t=this.props,a=t.oidc,n=t.tasks,o=t.schedule,i=t.config,c=r.a.createElement(Ne.a,null,n.map(function(t){return r.a.createElement(Se.a,{key:t.title,style:{flexDirection:"column",alignItems:"stretch"},active:e.state.current===t,action:!0,onClick:function(){return e.setState({current:e.state.current===t?null:t})}},r.a.createElement(je.a,null,t.title),e.state.current===t?r.a.createElement(Ce.a,{style:{color:"#212121"},tag:"div"},o.loaded?r.a.createElement(Ke.a,{style:{backgroundColor:"white"}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Capacity"),r.a.createElement("th",null,"Registered"),r.a.createElement("th",null,"Wait List"))),r.a.createElement("tbody",null,(o.courses[t.title]||[]).map(function(e){return r.a.createElement("tr",{style:K()().add("day",-2).isBefore(e.when)?null:{textDecoration:"line-through"},key:e.id},r.a.createElement("td",null,K()(e.when).format("HHmm ddd MMM Do")),r.a.createElement("td",null,e.capacity),r.a.createElement("td",null,e.current),r.a.createElement("td",null,e.waiting),r.a.createElement("td",null,r.a.createElement(Ee,{oidc:a},r.a.createElement(ke,{allowMember:!0},r.a.createElement(k.b,{to:"".concat(i.localRoot,"/admin/courses/").concat(e.id)},"Roster")))))}))):r.a.createElement("div",null,r.a.createElement("i",{className:"fa fa-spin fa-circle-o-notch"})," Loading ...")):null)}));return r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(Ee,{oidc:a},r.a.createElement(ke,{allowMember:!0,showDenied:!0},r.a.createElement(k.b,{to:"/admin"},"< Admin Home"),r.a.createElement("div",null,"Course List"),c)))}}]),t}(n.Component),Ze=Object(c.b)(function(e){return{config:e.config,oidc:e.oidc,schedule:e.schedule,tasks:e.tasks.filter(function(e){return"session"===e.category})}},function(e,t){return{getScheduleData:function(){return e(J(!1))}}})(Ye),$e=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={courseId:e.match.params.courseId,display:"table",loaded:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){console.log("did mount"),(this.props.oidc.user||{}).access_token&&this.props.getScheduleData()}},{key:"componentDidUpdate",value:function(e){!this.props.oidc.user&&!{}.access_token||(e.oidc.user||{}).access_token||this.props.schedule.loaded||this.props.getScheduleData()}},{key:"componentWillUpdate",value:function(e,t){var a=this;if(console.log("will update"),!this.state.offering&&e.schedule.loaded){var n=e.schedule.courses,r=Object.keys(n).reduce(function(e,a){return e||n[a].reduce(function(e,n){return e||(n.id===t.courseId?{title:a,offering:n}:null)},null)},null);this.setState({offering:r}),this.props.getRosterData(r.title,r.offering).then(function(){return a.setState({loaded:!0})})}}},{key:"getTrainee",value:function(e){return(this.props.trainees.items||[]).find(function(t){return t.id.toLowerCase()===e.toLowerCase()})}},{key:"renderTable",value:function(e){var t=this;return r.a.createElement(Ke.a,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Last Name"),r.a.createElement("th",null,"First Name"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Phone"),r.a.createElement("th",null,"Wait List?"))),r.a.createElement("tbody",null,e.items.map(function(e){var a=t.getTrainee(e.memberId),n=(a||{}).contacts||[];return r.a.createElement("tr",{key:e.id},a?r.a.createElement("td",null,a.last):r.a.createElement("td",{colSpan:"2"},e.name),a?r.a.createElement("td",null,a.first):null,r.a.createElement("td",null,(n.find(function(e){return"email"===e.type})||{}).value),r.a.createElement("td",null,(n.find(function(e){return"phone"===e.type})||{}).value),r.a.createElement("td",null,e.onWaitList?r.a.createElement("i",{className:"fa fa-hourglass"}):null))})))}},{key:"render",value:function(){var e=this.props,t=e.oidc,a=e.roster,n=this.state.offering||{},o=n.offering;return r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(Ee,{oidc:t},r.a.createElement(ke,{allowMember:!0,showDenied:!0},r.a.createElement(k.b,{to:"/admin/courses"},"< Course List"),r.a.createElement("div",null,"Course Roster for ",n.title||r.a.createElement("i",{className:"fa fa-spin fa-circle-o-notch"})),o?r.a.createElement("div",null,K()(o.when).format("HHmm ddd MMM Do")):null,this.state.loaded&&a.loaded?this.renderTable(a):r.a.createElement("div",null,"Loading ..."))))}}]),t}(n.Component),Xe=Object(c.b)(function(e){return{config:e.config,oidc:e.oidc,schedule:e.schedule,roster:e.roster,trainees:e.trainees}},function(e,t){return{getScheduleData:function(){return e(J(!1))},getRosterData:function(t,a){return e(V(t,a))}}})($e),et=a(148),tt=a(149),at=a(150),nt=(a(135),function(e){function t(){return Object(m.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"step"},r.a.createElement("div",null,r.a.createElement("div",{className:"step-circle"},this.props.step),r.a.createElement("div",{className:"step-line hidden-xs-down"})),r.a.createElement("div",null,r.a.createElement("div",{className:"step-title"},this.props.title),r.a.createElement("div",{className:"step-body"},this.props.children)))}}]),t}(n.Component)),rt=[{name:"Core/First Aid",id:"f9975ace-6ac0-4655-abac-6e4cf7c78802"},{name:"Core/CPR",id:"25dd4c86-31a7-4b07-a665-3b87fa94a45d"}];function ot(e){var t=e.account,a=e.memberId,n=e.sendInvitation,o=e.sendingInvite,i=null;return t.username&&t.username.length&&n&&(i=r.a.createElement("button",{disabled:o,onClick:function(){return n(a,t.username)}},"Send Invitation")),r.a.createElement("div",null,r.a.createElement("strong",null,t.username)," (",t.name||"unnamed"," / ",t.email,") ",i)}var it=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).changeFirst=function(e){a.setState({firstname:e.target.value})},a.changeMiddle=function(e){a.setState({middlename:e.target.value})},a.changeLast=function(e){a.setState({lastname:e.target.value})},a.changeBirth=function(e){a.setState({birthdate:e.target.value})},a.changeGender=function(e){a.setState({gender:e.target.value})},a.changeEmail=function(e){a.setState({email:e.target.value})},a.changePhone=function(e){a.setState({phone:e.target.value})},a.changeUsername=function(e){a.setState({username:e.target.value})},a.componentDidUpdate=function(e,t){a.state.firstname===t.firstname&&a.state.lastname===t.lastname||a.throttledMemberSearch(),a.state.username!==t.username&&a.throttledUserSearch()},a.useMember=function(e){a.setState({newMember:!1,memberName:e.name,memberId:e.id,memberSearchList:[]}),a.loadMember(e.id)},a.throttledMemberSearch=function(){a.memberLookupTimer&&clearTimeout(a.memberLookupTimer),a.memberLookupTimer=setTimeout(function(){var e;u.a.get("".concat(a.props.config.remoteRoot,"/search?t=Member&q=").concat(a.state.lastname),{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){a.setState({memberSearchList:e.data})}).finally(function(e){a.memberLookupTimer=null,a.setState({memberQueryToken:null})}),a.setState({memberQueryToken:e})},250)},a.createMember=function(){var e;if(K()(a.state.birthdate).isValid())if(a.state.firstname&&a.state.lastname){var t={first:a.state.firstname,middle:a.state.middlename,last:a.state.lastname,birthDate:a.state.birthdate,gender:a.state.gender};u.a.post("".concat(a.props.config.localRoot,"/api/trainees"),t,{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){a.setState({memberId:e.data.memberId,memberName:e.data.name,memberSearchList:[]}),a.loadMember(e.data.memberId)}).catch(function(e){alert("Failed to create member in database")}).finally(function(e){a.setState({creatingMemberToken:null})}),a.setState({creatingMemberToken:e})}else alert("First and last name required");else alert("Invalid birth date.")},a.loadMember=function(e){a.setState({loadingMember:!0}),u.a.all([u.a.get("".concat(a.props.config.remoteRoot,"/members/").concat(e,"/contacts")),u.a.get("".concat(a.props.config.remoteRoot,"/members/").concat(e,"/trainingrecords")),u.a.get("".concat(a.props.config.authRoot,"/account/formember/").concat(e))]).then(u.a.spread(function(e,t,a){var n=e.data.filter(function(e){return"email"===e.type});n.length>0&&this.setState({email:n[0].value,emailId:n[0].id});var r=e.data.filter(function(e){return"phone"===e.type});r.length>0&&this.setState({phone:r[0].value,phoneId:r[0].id});var o=t.data.items.reduce(function(e,t){return e[t.course.id]=t,e},{});this.setState({trainings:o}),this.setState({userAccounts:a.data.data})}.bind(Object(we.a)(a)))).finally(function(){a.setState({loadingMember:!1})})},a.createEmail=function(){var e,t={type:"email",value:a.state.email};console.log("create email",t),u.a.post("".concat(a.props.config.remoteRoot,"/members/").concat(a.state.memberId,"/contacts"),t,{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){a.setState({email:e.data.value,emailId:e.data.id})}).finally(function(){a.setState({creatingEmailToken:null})}),a.setState({creatingEmailToken:e})},a.createPhone=function(){var e,t={type:"phone",subType:"cell",value:a.state.phone};console.log("create phone",t),u.a.post("".concat(a.props.config.remoteRoot,"/members/").concat(a.state.memberId,"/contacts"),t,{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){a.setState({phone:e.data.value,phoneId:e.data.id})}).finally(function(){a.setState({creatingPhoneToken:null})}),a.setState({creatingPhoneToken:e})},a.throttledUserSearch=function(){/^[a-zA-Z][a-zA-Z.-]+$/.test(a.state.username)?(a.usernameLookupTimer&&clearTimeout(a.usernameLookupTimer),a.usernameLookupTimer=setTimeout(function(){var e;u.a.get("".concat(a.props.config.authRoot,"/account/checkname/").concat(a.state.username),{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){console.log("username query",e.data),a.setState({usernameOk:e.data.data.available})}).finally(function(e){a.usernameLookupTimer=null,a.setState({usernameQueryToken:null})}),a.setState({usernameQueryToken:e})},250)):a.setState({usernameOk:!1})},a.createUser=function(){var e,t={username:a.state.username,email:a.state.email,name:a.state.memberName,memberId:a.state.memberId};console.log("create user",t),u.a.post("".concat(a.props.config.authRoot,"/account"),t,{cancelToken:new l.CancelToken(function(t){e=t})}).then(function(e){a.setState({userAccounts:[e.data.data]})}).finally(function(){a.setState({creatingUserToken:null})}),a.setState({creatingUserToken:e}),window.setTimeout(function(){a.setState({creatingUserToken:null})},1e3),a.setState({creatingUserToken:"hi"})},a.sendInvitation=function(e,t){a.setState({sendingInvite:!0});var n="".concat(a.props.config.localRoot,"/api/trainees/").concat(e,"/invite");t&&(n+="?username=".concat(t)),u.a.post(n,{}).catch(function(){alert("Failed to send invite")}).finally(function(e){a.setState({sendingInvite:!1})})},a.state={newMember:!0,firstname:"",middlename:"",lastname:"",birthdate:"",memberQueryToken:null,memberSearchList:[],memberName:"",memberId:"",gender:"unknown",creatingMemberToken:null,loadingMember:!1,email:"",emailId:"",phone:"",phoneId:"",trainings:null,username:"",userQueryToken:null,usernameOk:!0,userAccounts:[]},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.oidc,a=null;return this.state.memberId&&(a=r.a.createElement("div",null,"Loading ..."),this.state.trainings&&(a=rt.map(function(t){var a=e.state.trainings[t.id],n=void 0===a||null===a?r.a.createElement("div",null,"not found"):"Complete"===a.status||"NotExpired"===a.status?r.a.createElement("span",{style:{color:"#008800"}}," ","\u2713"):"Expired"===a.status?r.a.createElement("span",{style:{color:"#800"}}," Expired"):r.a.createElement("span",null," Status ",a.status," unknown, please check");return r.a.createElement("div",{key:t.id},t.name,n)}))),r.a.createElement(Ee,{oidc:t},r.a.createElement(ke,{group:"acct-managers",showDenied:!0},r.a.createElement("div",{className:"container-fluid py-4"},r.a.createElement(nt,{step:1,title:"Find / Create Member"},this.state.newMember?r.a.createElement("div",{className:"row"},r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"lastname"},"Last Name"),r.a.createElement(at.a,{name:"lastname",value:this.state.lastname,onChange:this.changeLast,readOnly:!!this.state.memberId})),r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"firstname"},"First Name"),r.a.createElement(at.a,{name:"firstname",value:this.state.firstname,onChange:this.changeFirst,readOnly:!!this.state.memberId})),r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"middlename"},"Middle Name"),r.a.createElement(at.a,{name:"middlename",value:this.state.middlename,onChange:this.changeMiddle,readOnly:!!this.state.memberId}))):r.a.createElement("div",null,"Existing member ",this.state.memberName," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:this.props.config.remoteRoot.replace("/api2","/members/detail/".concat(this.state.memberId))},"database")),this.state.newMember?r.a.createElement("div",{className:"row"},r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"birthdate"},"Birth Date (yyyy-mm-dd)"),r.a.createElement(at.a,{name:"birthdate",value:this.state.birthdate,onChange:this.changeBirth,readOnly:!!this.state.memberId})),r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"gender"},"Gender"),r.a.createElement(at.a,{type:"select",name:"gender",value:this.state.gender,onChange:this.changeGender,disabled:!!this.state.memberId},r.a.createElement("option",{value:"unknown"},"Unknown / Other"),r.a.createElement("option",{value:"male"},"Male"),r.a.createElement("option",{value:"female"},"Female")))):null,this.state.newMember&&!this.state.memberId?r.a.createElement("button",{className:"btn btn-primary",disabled:this.state.creatingMember,onClick:this.createMember},"Create Member",this.state.creatingMemberToken?r.a.createElement("span",null," ",r.a.createElement("i",{className:"fa fa-fw fa-spin fa-spinner"})):null):null,r.a.createElement("div",null,null!=this.state.memberQueryToken?r.a.createElement("div",null,"Searching ..."):null,this.state.memberSearchList.length>0?r.a.createElement("div",null,"Possible existing members:"):null,this.state.memberSearchList.map(function(t){return r.a.createElement("div",{key:t.summary.id},t.summary.name," ",r.a.createElement("button",{onClick:function(){return e.useMember(t.summary)}},"use")," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.props.config.remoteRoot.replace("/api2","/members/detail/".concat(t.summary.id))},"database"))}))),r.a.createElement(nt,{step:2,title:"Contact Information"},this.state.memberId?r.a.createElement("div",{className:"row"},r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"email"},"Email"),r.a.createElement(at.a,{name:"email",value:this.state.email,onChange:this.changeEmail,readOnly:!!this.state.emailId}),this.state.emailId?null:r.a.createElement("button",{className:"btn btn-primary",disabled:this.state.creatingEmailToken,onClick:this.createEmail},"Save",this.state.creatingEmailToken?r.a.createElement("span",null," ",r.a.createElement("i",{className:"fa fa-fw fa-spin fa-spinner"})):null)),r.a.createElement(et.a,{className:"col-12 col-md"},r.a.createElement(tt.a,{for:"phone"},"Cell Number"),r.a.createElement(at.a,{name:"phone",value:this.state.phone,onChange:this.changePhone,readOnly:!!this.state.phoneId}),this.state.phoneId?null:r.a.createElement("button",{className:"btn btn-primary",disabled:this.state.creatingPhoneToken,onClick:this.createPhone},"Save",this.state.creatingPhoneToken?r.a.createElement("span",null," ",r.a.createElement("i",{className:"fa fa-fw fa-spin fa-spinner"})):null))):null),r.a.createElement(nt,{step:3,title:"Prerequisite Training"},a),r.a.createElement(nt,{step:4,title:"User Account"},this.state.memberId?this.state.userAccounts.length?r.a.createElement("div",null,this.state.userAccounts.length&&!this.state.username?r.a.createElement("div",null,"This user already has one or more accounts:"):null,this.state.userAccounts.map(function(t){return r.a.createElement(ot,{key:t.id,account:t,memberId:e.state.memberId,sendInvitation:e.state.username?null:e.sendInvitation,sendingInvite:e.state.sendingInvite})})):r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(et.a,{className:"col-6 col-md"},r.a.createElement(tt.a,{for:"username"},"Username"),r.a.createElement(at.a,{name:"username",value:this.state.username,onChange:this.changeUsername}))),r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",disabled:!(this.state.emailId&&this.state.username&&this.state.usernameOk),onClick:this.createUser},"Create User",this.state.creatingUser?r.a.createElement("span",null," ",r.a.createElement("i",{className:"fa fa-fw fa-spin fa-spinner"})):null),this.state.usernameOk?null:r.a.createElement("div",{className:"text-danger"},"Username is invalid or already exists"),this.state.emailId?null:r.a.createElement("div",{className:"text-warning"},"Member needs at least one email"))):null))))}}]),t}(n.Component),ct=Object(c.b)(function(e){return{oidc:e.oidc,user:e.oidc?e.oidc.user:void 0,config:e.config}},function(e,t){return{getUserData:function(){return e(Q())}}})(it),st=function(e){var t=ae.getState(),a=t.member,n=t.oidc;console.log("watchMemberId",e.match,n,a);var r=((e.match||{}).params||{}).memberId||(((n||{}).user||{}).profile||{}).memberId;return r!==(a||{}).id&&ae.dispatch({type:x,payload:{id:r}}),null};ae.subscribe(function(){st({match:{params:{memberId:ae.getState().member.id}}})});var lt=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={isOpen:!1},a.toggleAuth=function(){var e=a.props,t=e.user,n=e.doSignin,r=e.doSignout;t&&t.token_type?r():n()},a.toggle=function(){a.setState({isOpen:!a.state.isOpen})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.user;return r.a.createElement(s.OidcProvider,{store:ae,userManager:N},r.a.createElement(k.a,null,r.a.createElement(O.GatewayProvider,null,r.a.createElement("div",null,r.a.createElement(g.a,{color:"dark",dark:!0,expand:"md"},r.a.createElement(b.a,{onClick:this.toggle}),r.a.createElement(k.b,{to:"/",className:"navbar-brand"},"King County ESAR",r.a.createElement("span",{className:"hidden-xs-down"}," - Basic Training")),r.a.createElement(E.a,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(v.a,{className:"ml-auto",navbar:!0},r.a.createElement(y.a,null,r.a.createElement("button",{className:"nav-link",onClick:this.toggleAuth},"Sign ",e&&e.token_type?"out":"in"))))),r.a.createElement(w.a,{exact:!0,path:"/loggedIn",component:re}),r.a.createElement(w.a,{exact:!0,path:"/",component:ge}),r.a.createElement(w.a,{path:"/me",render:st}),r.a.createElement(w.a,{exact:!0,path:"/me",component:He}),r.a.createElement(w.a,{exact:!0,path:"/admin",component:ze}),r.a.createElement(w.a,{path:"/admin/trainees/:memberId",render:st}),r.a.createElement(w.a,{exact:!0,path:"/admin/trainees",component:Je}),r.a.createElement(w.a,{exact:!0,path:"/admin/trainees/:memberId",component:He}),r.a.createElement(w.a,{exact:!0,path:"/courses",component:Ze}),r.a.createElement(w.a,{exact:!0,path:"/admin/courses",component:Ze}),r.a.createElement(w.a,{exact:!0,path:"/admin/courses/:courseId(\\\\d+)",component:Xe}),r.a.createElement(w.a,{exact:!0,path:"/admin/register",component:ct}),r.a.createElement("div",{className:"container py-4"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{style:{margin:"0 auto",textAlign:"center",padding:"5px",fontSize:"90%"}},"\xa9 2019 - This project is open source. View it on ",r.a.createElement("a",{href:"https://github.com/kcesar/esar-training"},"GitHub")))),r.a.createElement(O.GatewayDest,{name:"root"})))))}}]),t}(n.Component),ut=Object(c.b)(function(e){return{user:e.oidc.user}},function(e,t){return{doSignin:function(){return e(function(e,t){var a=t();if(!a.oidc.user||!a.oidc.user.token_type){var n="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":".concat(window.location.port):"");return sessionStorage.setItem("redirect",window.location.href.substring(n.length)),N.signinRedirect()}return Promise.resolve()})},doSignout:function(){return e(function(e,t){var a=t();return a.oidc.user&&a.oidc.user.token_type?(e({type:P}),sessionStorage.setItem("redirect",window.baseUrl||"/"),N.signoutRedirect()):Promise.resolve()})}}})(lt);a(136),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.interceptors.request.use(function(e){var t=ae.getState().oidc.user;return t&&t.access_token&&(e.headers.Authorization="Bearer "+t.access_token),e},function(e){return Promise.reject(e)}),Object(s.loadUser)(ae,N),i.a.render(r.a.createElement(c.a,{store:ae},r.a.createElement(ut,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},62:function(e,t,a){e.exports=a.p+"static/media/can2-checkin.a033bc23.jpg"},63:function(e,t,a){e.exports=a.p+"static/media/team-evac.49e3a532.jpg"},64:function(e,t,a){e.exports=a.p+"static/media/in-the-woods.3ae90303.jpg"},65:function(e,t,a){e.exports=a.p+"static/media/litter-wheel.4fc5ac65.jpg"},70:function(e,t,a){e.exports=a(137)},97:function(e,t,a){}},[[70,1,2]]]);
//# sourceMappingURL=main.25983fd6.chunk.js.map